## 🏠 전세사기 피해자 지원 AI 모델

> **전세사기 피해자의 심리적 안정과 객관적인 지원 자격 진단, 그리고 맞춤형 정보 제공을 위한 통합 AI 상담 시스템입니다.**

---

## 🌟 1. 프로젝트 개요 및 주요 기능

본 프로젝트는 **3가지 핵심 지능 모듈**을 통합하여 작동하는 챗봇 시스템입니다. 사용자의 초기 위기 상황을 감지하여 안전을 확보하고, 진단 결과를 바탕으로 **RAG(검색 증강 생성) 기술**을 통해 정확하고 구조화된 맞춤 정보를 제공합니다.

### 주요 기능 (Features)

1.  **🚨 위기 감지 및 긴급 대응:** '죽고싶다' 등 위기 키워드 감지 시 즉시 1393 연락처 안내.
2.  **✅ 피해자 요건 진단:** 7개 항목을 통한 정량적인 지원 등급 (`user_situation`) 판별.
3.  **📚 RAG 기반 맞춤 상담:** 피해자 등급에 맞춰 법률, 금융, 주거 지원 등 구체적인 정보를 제공.
4.  **🛡️ 주택 위험도 분석:** (별도 모듈) 서울시 실거래가 API를 이용한 전세사기 위험 점수 및 등급 산출.
5.  **🔗 자동 부가 정보:** 답변에 관련 웹사이트 링크 및 관할 자치구 연락처를 자동으로 첨부.

---

## 🛠️ 2. 기술 스택 (Tech Stack)

| 분류 | 기술 | 역할 |
| :--- | :--- | :--- |
| **프레임워크** | LangChain Core (LCEL) | AI 파이프라인 구성 및 모듈 연결 |
| **LLM** | Google Gemini 2.5 Flash | 최종 사용자 답변 생성 |
| **벡터 DB** | FAISS | 대규모 지식 문서의 고속 유사도 검색 |
| **임베딩** | HuggingFace MiniLM-L6-v2 | 384차원 벡터 임베딩 |
| **데이터 연동** | Seoul Open API (XML) | 주택 위험도 분석을 위한 실거래가 데이터 수집 |

---

## 💻 3. 시스템 아키텍처 및 모듈 상세

시스템은 `classifier`, `rag_engine`, `risk_analyzer` 세 가지 주요 모듈로 구성됩니다.

### A. 심리 및 상황 진단 모듈 (`classifier` 폴더)

* **역할:** 상담 시작, 감정 분석, 지원 자격 진단.
* **작동:** 사용자의 감정을 분석하여 **위기 시 1393 안내**를 최우선으로 합니다. 피해자 요건 7가지 질문을 통해 지원 등급을 확정하며, 이 등급은 RAG 시스템의 **가장 중요한 맥락 정보**로 사용됩니다.

### B. RAG 기반 상담 모듈 (`rag_engine` 폴더)

* **역할:** 진단 결과에 맞는 **정확하고 구조화된** 답변 생성.
* **작동:**
    * **DB 구축:** `create_db.py`가 문서를 **MiniLM $\rightarrow$ FAISS**로 인덱싱합니다.
    * **체인 실행:** `run_chain.py`가 Gemini 2.5 Flash를 구동하여 검색된 문서를 바탕으로 답변합니다.
    * **구조화:** 답변은 `define_prompt.py`의 지침에 따라 **4가지 마크다운 섹션**으로(상황, 혜택, 신청, 연락처) 명확히 분리됩니다.
    * **후처리:** `contact_info.py` 및 `useful_links.py`의 데이터를 활용해 자치구 연락처와 관련 링크를 최종 답변에 첨부합니다.

### C. 위험도 분석 모듈 (`risk_analyzer` 폴더)

* **역할:** 주택 계약의 **전세사기 위험도를 객관적으로 진단**.
* **작동:** `seoul_api_client.py`가 서울시 API를 호출하여 실거래가를 수집합니다. `risk_calculator.py`는 **논문 기반 규칙 시스템**을 적용, **전세가율, 근저당, 체납액** 등의 가중 합산으로 위험 점수(100점 만점)와 5단계 등급을 산출하여 사용자에게 조치 수준을 권고합니다.

---

## 📂 폴더 구조
```bash
├── ai_modules/
│   ├── classifier/
│   │   ├── classifier_logic.py (이전 메인 파이프라인)
│   │   ├── system_prompt.txt
│   │   └── ... (프롬프트 유틸)
│   ├── rag_engine/
│   │   ├── run_chain.py (RAG 실행 및 LLM 호출)
│   │   ├── create_db.py (벡터 DB 구축)
│   │   ├── contact_info.py (자치구 연락처 DB)
│   │   ├── useful_links.py (키워드별 링크 DB)
│   │   └── ... (프롬프트 정의, 모델 체크)
│   └── risk_analyzer/
│       ├── main2.py (CLI 실행 파일)
│       ├── seoul_api_client.py (서울시 API 연동)
│       ├── risk_calculator.py (논문 기반 점수 산출)
│       └── ... (더미 데이터, __init__.py)
├── main.py .......................... (통합 실행: 진단 + RAG 대화 루프)
├── test_cli.py ...................... (대화 이력 관리 기능이 강화된 테스트 콘솔)
├── .gitignore ....................... (제외 파일 목록)
└── __init__.py ...................... (모듈 외부 노출 설정)
``` 
<br>
